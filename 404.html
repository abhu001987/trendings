<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Redirecting...</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCaa2pD-iuQe35N4CAgWpgZdAsWDrpNYRQ",
      authDomain: "myaffiliatepage-fdc27.firebaseapp.com",
      projectId: "myaffiliatepage-fdc27",
      storageBucket: "myaffiliatepage-fdc27.firebasestorage.app",
      messagingSenderId: "998138300141",
      appId: "1:998138300141:web:180cffa98550c16167eee4",
      measurementId: "G-DWCGT207YP"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const path = window.location.pathname.replace("/", "").trim();

    async function redirectNow() {
      if (!path) return;
      const ref = doc(db, "links", path);
      const snap = await getDoc(ref);

      if (snap.exists()) {
        window.location.href = snap.data().url;
      } else {
        document.body.innerHTML = "<h3 style='color:#074b6d;text-align:center;padding-top:50px;'>⚠️ Link not found</h3>";
      }
    }

    redirectNow();
  </script>
</head>
<body style="font-family:sans-serif;text-align:center;color:#074b6d;padding-top:40px;">
  Redirecting...
</body>
</html>
